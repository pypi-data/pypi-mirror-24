Metadata-Version: 2.0
Name: torch2coreml
Version: 0.0.5
Summary: Convert Torch7 models into Apple CoreML format.
Home-page: https://github.com/prisma-ai/torch2coreml/
Author: Oleg Poyaganov
Author-email: oleg@prisma-ai.com
License: MIT
Keywords: coreml machinelearning ml coremltools torch converter neural
Platform: UNKNOWN
Classifier: Development Status :: 4 - Beta
Classifier: License :: OSI Approved :: MIT License
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: End Users/Desktop
Classifier: Operating System :: MacOS :: MacOS X
Classifier: Programming Language :: Python :: 2.7
Classifier: Topic :: Scientific/Engineering
Classifier: Topic :: Software Development
Requires-Python: ==2.7.*
Requires-Dist: coremltools (>=0.5.0)
Requires-Dist: torch

Convert Torch7 models into Apple CoreML format.
===============================================

This tool helps convert Torch7 models into `Apple
CoreML <https://developer.apple.com/documentation/coreml>`__ format
which can then be run on Apple devices.

Installation
------------

.. code:: bash

    pip install -U torch2coreml

In order to use this tool you need to have these installed: \* Xcode 9
\* python 2.7

If you want to run tests, you need MacOS High Sierra 10.13 installed.

Dependencies
------------

-  coremltools (0.6.2+)
-  PyTorch

How to use
----------

Using this library you can implement converter for your own model types.
An example of such a converter is located at
"example/fast-neural-style/convert-fast-neural-style.py". To implement
converters you should use single function "convert" from torch2coreml:

.. code:: python

    from torch2coreml import convert

This function is simple enough to be self-describing:

.. code:: python

    def convert(model,
                input_shape,
                input_name='input',
                output_name='output',
                mode=None,
                is_image_input=False,
                preprocessing_args={},
                is_image_output=False,
                deprocessing_args={},
                class_labels=None,
                predicted_feature_name='classLabel')

Parameters
~~~~~~~~~~

| **model**: Torch7 model (loaded with PyTorch) \| str
| A trained Torch7 model loaded in python using PyTorch or path to file
  with model (\*.t7).

| **input\_shape**: tuple
| Shape of the input tensor.

| **mode**: str ('classifier', 'regressor' or None)
| Mode of the converted coreml model:
| 'classifier', a NeuralNetworkClassifier spec will be constructed.
| 'regressor', a NeuralNetworkRegressor spec will be constructed.

| **preprocessing\_args**: dict
| 'is\_bgr', 'red\_bias', 'green\_bias', 'blue\_bias', 'gray\_bias',
  'image\_scale' keys with the same meaning as
  https://apple.github.io/coremltools/generated/coremltools.models.neural\_network.html#coremltools.models.neural\_network.NeuralNetworkBuilder.set\_pre\_processing\_parameters

| **deprocessing\_args**: dict
| Same as 'preprocessing\_args' but for deprocessing.

| **class\_labels**: A string or list of strings.
| As a string it represents the name of the file which contains the
  classification labels (one per line). As a list of strings it
  represents a list of categories that map the index of the output of a
  neural network to labels in a classifier.

| **predicted\_feature\_name**: str
| Name of the output feature for the class labels exposed in the Core ML
  model (applies to classifiers only). Defaults to 'classLabel'

Returns
~~~~~~~

model: A coreml model.

Currently supported
-------------------

Models
~~~~~~

Only Torch7 "nn" module is supported now.

Layers
~~~~~~

List of Torch7 layers that can be converted into their CoreML
equivalent:

1.  Sequential
2.  ConcatTable
3.  SpatialConvolution
4.  ELU
5.  ReLU
6.  SpatialBatchNormalization
7.  Identity
8.  CAddTable
9.  SpatialFullConvolution
10. SpatialSoftMax
11. SpatialMaxPooling
12. SpatialAveragePooling
13. View
14. Linear
15. Tanh
16. MulConstant
17. SpatialZeroPadding
18. SpatialReflectionPadding
19. Narrow

License
-------

Copyright (c) 2017 Prisma Labs, Inc. All rights reserved.

Use of this source code is governed by the `MIT
License <https://opensource.org/licenses/MIT>`__ that can be found in
the LICENSE.txt file.


