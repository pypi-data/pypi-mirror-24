var get_choices=function(form,field_name){var fields=form.find('input[name="'+field_name+'"]:checked');if(fields.length===0){return null;}
return _.map($(fields),function(f){return $(f).val();});};var get_relevant_forms=function(){return $('form:has(*[data-depends-on])');};var get_dependencies=function(input){var hide_label=true;if(!_.isUndefined(input.data('hide-label'))){hide_label=input.data('hide-label');}
var dependencies=input.data('depends-on').split(';');return _.map(dependencies,function(dependency){var name=dependency.split('/')[0];var value=dependency.substring(name.length+1);var invert=value.indexOf('!')===0;if(invert){value=value.substring(1);}
return{'name':name,'value':value,'invert':invert,'hide_label':hide_label};});};var get_dependency_target=function(form,dependency){return form.find('input[name="'+dependency.name+'"]');};var evaluate_dependencies=function(form,input,dependencies){var visible=true;var hide_label=true;_.each(dependencies,function(dependency){visible&=(dependency.invert^_.contains(get_choices(form,dependency.name),dependency.value));hide_label&=dependency.hide_label;});if(visible){input.show();input.closest('label, .group-label').show().siblings('.error').show();}else{input.hide();if(hide_label){input.closest('label, .group-label').hide().siblings('.error').hide();}}};var setup_depends_on=function(form){var inputs=form.find('*[data-depends-on]');form.hide();_.each(_.map(inputs,$),function(input){var dependencies=get_dependencies(input);evaluate_dependencies(form,input,dependencies);_.each(dependencies,function(dependency){get_dependency_target(form,dependency).on('click',function(){evaluate_dependencies(form,input,dependencies);});});});form.show();};$(document).ready(function(){if($('form').length===0){return;}
_.each(get_relevant_forms(),function(form){setup_depends_on($(form));});});if(!Modernizr.inputtypes.date){$('input[type=date]').datetimepicker({allowBlank:true,dayOfWeekStart:1,format:'Y-m-d',lang:'de',lazyInit:true,timepicker:false});}
$(document).foundation();$('.stackable').stacktable();$('.chosen-select').chosen({no_results_text:"Keine Ergebnisse gefunden:",placeholder_text_multiple:"Mehrere Optionen auswählen",placeholder_text_single:"Eine Option auswählen"});$('ul.actions').each(function(index,element){$(element).before($('<a></a>').attr('href','#').attr('class','button split small action-button secondary').on('click',function(){$(element).toggle();return false;}).html($(this).data('title')+' <span></span>')).hide();$(element).parent('td').addClass('row-actions');});Foundation.libs.dropdown.small=function(){return false;};$('ul[data-limit]').each(function(){var ul=$(this);ul.children('li:not(.expand)').slice(ul.data('limit')).hide();ul.append($('<li></li>').attr('class','expand').html($('<a></a>').attr('href','#').attr('class','action-expand').on('click',function(){ul.children('li:not(.expand)').show();ul.children('li.expand').hide();return false;}).html(ul.data('expand-title')||'Show all')));ul.append($('<li></li>').attr('class','fold').html($('<a></a>').attr('href','#').attr('class','action-fold').on('click',function(){ul.children('li:not(.expand)').slice(ul.data('limit')).hide();ul.children('li.expand').show();ul.children('li.fold').hide();return false;}).html(ul.data('fold-title')||'Show less')).hide());});