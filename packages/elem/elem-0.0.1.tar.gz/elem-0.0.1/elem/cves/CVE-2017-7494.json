{"public_date": "2017-05-24T00:00:00", "name": "CVE-2017-7494", "affected_release": [{"advisory": "RHSA-2017:1270", "release_date": "2017-05-24T00:00:00", "cpe": "cpe:/o:redhat:enterprise_linux:6", "product_name": "Red Hat Enterprise Linux 6", "package": "samba-0:3.6.23-43.el6_9"}, {"advisory": "RHSA-2017:1271", "release_date": "2017-05-24T00:00:00", "cpe": "cpe:/o:redhat:enterprise_linux:6", "product_name": "Red Hat Enterprise Linux 6", "package": "samba4-0:4.2.10-10.el6_9"}, {"advisory": "RHSA-2017:1270", "release_date": "2017-05-24T00:00:00", "cpe": "cpe:/o:redhat:enterprise_linux:7", "product_name": "Red Hat Enterprise Linux 7", "package": "samba-0:4.4.4-14.el7_3"}, {"advisory": "RHSA-2017:1390", "release_date": "2017-06-05T00:00:00", "cpe": "cpe:/o:redhat:rhel_aus:6.4", "product_name": "Red Hat Enterprise Linux Advanced Update Support 6.4", "package": "samba-0:3.6.23-32.el6_4"}, {"advisory": "RHSA-2017:1390", "release_date": "2017-06-05T00:00:00", "cpe": "cpe:/o:redhat:rhel_aus:6.5", "product_name": "Red Hat Enterprise Linux Advanced Update Support 6.5", "package": "samba-0:3.6.23-32.el6_5"}, {"advisory": "RHSA-2017:1390", "release_date": "2017-06-05T00:00:00", "cpe": "cpe:/o:redhat:rhel_aus:6.6", "product_name": "Red Hat Enterprise Linux Advanced Update Support 6.6", "package": "samba-0:3.6.23-32.el6_6"}, {"advisory": "RHSA-2017:1272", "release_date": "2017-05-24T00:00:00", "cpe": "cpe:/o:redhat:rhel_els:5", "product_name": "Red Hat Enterprise Linux Server (v. 5 ELS)", "package": "samba3x-0:3.6.23-14.el5_11"}, {"advisory": "RHSA-2017:1390", "release_date": "2017-06-05T00:00:00", "cpe": "cpe:/o:redhat:rhel_eus:6.7", "product_name": "Red Hat Enterprise Linux Extended Update Support 6.7", "package": "samba-0:3.6.23-32.el6_7"}, {"advisory": "RHSA-2017:1390", "release_date": "2017-06-05T00:00:00", "cpe": "cpe:/o:redhat:rhel_eus:7.1", "product_name": "Red Hat Enterprise Linux Extended Update Support 7.1", "package": "samba-0:4.2.10-11.el7_2"}, {"advisory": "RHSA-2017:1390", "release_date": "2017-06-05T00:00:00", "cpe": "cpe:/o:redhat:rhel_eus:7.2", "product_name": "Red Hat Enterprise Linux Extended Update Support 7.2", "package": "samba-0:4.2.10-11.el7_2"}, {"advisory": "RHSA-2017:1390", "release_date": "2017-06-05T00:00:00", "cpe": "cpe:/o:redhat:rhel_mission_critical:6.2", "product_name": "Red Hat Enterprise Linux Advanced Update Support 6.2", "package": "samba-0:3.6.23-32.el6_2"}, {"advisory": "RHSA-2017:1390", "release_date": "2017-06-05T00:00:00", "cpe": "cpe:/o:redhat:rhel_tus:6.5", "product_name": "Red Hat Enterprise Linux Server TUS (v. 6.5)", "package": "samba-0:3.6.23-32.el6_5"}, {"advisory": "RHSA-2017:1390", "release_date": "2017-06-05T00:00:00", "cpe": "cpe:/o:redhat:rhel_tus:6.6", "product_name": "Red Hat Enterprise Linux Server TUS (v. 6.6)", "package": "samba-0:3.6.23-32.el6_6"}, {"advisory": "RHSA-2017:1273", "release_date": "2017-05-24T00:00:00", "cpe": "cpe:/a:redhat:storage:3.2:samba:el6", "product_name": "Red Hat Gluster 3.2 Samba on RHEL-6", "package": "samba-0:4.4.6-5.el6rhs"}, {"advisory": "RHSA-2017:1273", "release_date": "2017-05-24T00:00:00", "cpe": "cpe:/a:redhat:storage:3.2:samba:el7", "product_name": "Red Hat Gluster 3.2 Samba on RHEL-7", "package": "samba-0:4.4.6-5.el7rhgs"}], "acknowledgement": "\nRed Hat would like to thank the Samba project for reporting this issue. Upstream acknowledges steelo as the original reporter.\n    ", "package_state": {"fix_state": "Not affected", "product_name": "Red Hat Enterprise Linux 5", "package_name": "samba", "cpe": "cpe:/o:redhat:enterprise_linux:5"}, "document_distribution": "Copyright \u00a9 2016 Red Hat, Inc. All rights reserved.", "threat_severity": "Important", "bugzilla": {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1450347", "description": "\nCVE-2017-7494 samba: Loading shared modules from any path in the system leading to RCE (SambaCry)\n    ", "id": "1450347"}, "mitigation": "\nAny of the following:\n\n1. SELinux is enabled by default and our default policy prevents loading of modules from outside of samba's module directories and therefore blocks the exploit\n\n2. Mount the filesystem which is used by samba for its writable share using \"noexec\" option.\n\n3. Add the parameter:\n\n    nt pipe support = no\n\n    to the [global] section of your smb.conf and restart smbd. This prevents clients from accessing any named pipe endpoints. Note this can disable some expected functionality for Windows clients.\n    ", "references": ["\nhttps://www.samba.org/samba/security/CVE-2017-7494.html\n    "], "details": ["\nSamba since version 3.5.0 is vulnerable to remote code execution vulnerability, allowing a malicious client to upload a shared library to a writable share, and then cause the server to load and execute it.\n    ", "\nA remote code execution flaw was found in Samba. A malicious authenticated samba client, having write access to the samba share, could use this flaw to execute arbitrary code as root.\n    "], "cvss3": {"status": "verified", "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "cvss3_base_score": "7.5"}}