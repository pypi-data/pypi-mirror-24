{"name": "CVE-2017-5664", "affected_release": [{"advisory": "RHSA-2017:1809", "release_date": "2017-07-27T00:00:00", "cpe": "cpe:/o:redhat:enterprise_linux:7", "product_name": "Red Hat Enterprise Linux 7", "package": "tomcat-0:7.0.69-12.el7_3"}, {"advisory": "RHSA-2017:2493", "release_date": "2017-08-21T00:00:00", "product_name": "Red Hat JBoss Enterprise Web Server 2 for RHEL 6 Server", "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:2::el6"}, {"advisory": "RHSA-2017:2493", "release_date": "2017-08-21T00:00:00", "product_name": "Red Hat JBoss Enterprise Web Server 2 for RHEL 7 Server", "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:2::el7"}, {"advisory": "RHSA-2017:2494", "release_date": "2017-08-21T00:00:00", "product_name": "Red Hat JBoss Web Server 2.1", "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:2.1"}, {"advisory": "RHSA-2017:1802", "release_date": "2017-07-25T00:00:00", "product_name": "Red Hat JBoss Web Server 3.1", "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1"}, {"advisory": "RHSA-2017:1801", "release_date": "2017-07-25T00:00:00", "product_name": "Red Hat JBoss Web Server 3.1 for RHEL 6", "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1::el6"}, {"advisory": "RHSA-2017:1801", "release_date": "2017-07-25T00:00:00", "product_name": "Red Hat JBoss Web Server 3.1 for RHEL 7", "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1::el7"}], "public_date": "2017-06-06T00:00:00", "package_state": [{"fix_state": "Not affected", "product_name": "Red Hat JBoss Data Grid 6", "package_name": "jbossweb", "cpe": "cpe:/a:redhat:jboss_data_grid:6"}, {"fix_state": "Not affected", "product_name": "Red Hat JBoss Data Virtualization 6", "package_name": "jbossweb", "cpe": "cpe:/a:redhat:jboss_data_virtualization:6"}, {"fix_state": "Affected", "product_name": "Red Hat JBoss EAP 6", "package_name": "jbossweb", "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"}, {"fix_state": "Affected", "product_name": "Red Hat JBoss Portal Platform 6", "package_name": "jbossweb", "cpe": "cpe:/a:redhat:jboss_enterprise_portal_platform:6"}, {"fix_state": "New", "product_name": "Red Hat JBoss Fuse 6", "package_name": "jbossweb", "cpe": "cpe:/a:redhat:jboss_fuse:6"}, {"fix_state": "New", "product_name": "Red Hat JBoss Fuse 6", "package_name": "tomcat7", "cpe": "cpe:/a:redhat:jboss_fuse:6"}, {"fix_state": "New", "product_name": "Red Hat JBoss Fuse 6", "package_name": "tomcat8", "cpe": "cpe:/a:redhat:jboss_fuse:6"}, {"fix_state": "Will not fix", "product_name": "Red Hat JBoss Fuse Service Works 6", "package_name": "jbossweb", "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"}, {"fix_state": "Will not fix", "product_name": "Red Hat JBoss Operations Network 3", "package_name": "jbossweb", "cpe": "cpe:/a:redhat:jboss_operations_network:3"}, {"fix_state": "Not affected", "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux", "package_name": "rh-java-common-tomcat", "cpe": "cpe:/a:redhat:rhel_software_collections:2"}, {"fix_state": "Affected", "product_name": "Red Hat Enterprise Linux 6", "package_name": "tomcat6", "cpe": "cpe:/o:redhat:enterprise_linux:6"}], "document_distribution": "Copyright \u00a9 2016 Red Hat, Inc. All rights reserved.", "upstream_fix": "tomcat 7.0.78, tomcat 8.0.44, tomcat 8.5.15", "threat_severity": "Important", "bugzilla": {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1459158", "description": "\nCVE-2017-5664 tomcat: Security constrained bypass in error page mechanism\n    ", "id": "1459158"}, "mitigation": "\nIf it is necessary to have the DefaultServlet property readonly=false, use a jsp error page, for example Error404.jsp rather than a static html error page. Alternatively do not specify an error-page in the Deployment Descriptor and use a custom ErrorReportValve.\n    ", "references": ["\nhttps://tomcat.apache.org/security-7.html#Fixed_in_Apache_Tomcat_7.0.78\nhttps://tomcat.apache.org/security-8.html#Fixed_in_Apache_Tomcat_8.0.44\nhttps://tomcat.apache.org/security-8.html#Fixed_in_Apache_Tomcat_8.5.15\n    "], "details": ["\nThe error page mechanism of the Java Servlet Specification requires that, when an error occurs and an error page is configured for the error that occurred, the original request and response are forwarded to the error page. This means that the request is presented to the error page with the original HTTP method. If the error page is a static file, expected behaviour is to serve content of the file as if processing a GET request, regardless of the actual HTTP method. The Default Servlet in Apache Tomcat 9.0.0.M1 to 9.0.0.M20, 8.5.0 to 8.5.14, 8.0.0.RC1 to 8.0.43 and 7.0.0 to 7.0.77 did not do this. Depending on the original request this could lead to unexpected and undesirable results for static error pages including, if the DefaultServlet is configured to permit writes, the replacement or removal of the custom error page. Notes for other user provided error pages: (1) Unless explicitly coded otherwise, JSPs ignore the HTTP method.  JSPs used as error pages must must ensure that they handle any error dispatch as a GET request, regardless of the actual method.  (2) By default, the response generated by a Servlet does depend on the HTTP method.  Custom Servlets used as error pages must ensure that they handle any error dispatch as a GET request, regardless of the actual method.\n    ", "\nA vulnerability was discovered in the error page mechanism in Tomcat's DefaultServlet implementation. A crafted HTTP request could cause undesired side effects, possibly including the removal or replacement of the custom error page.\n    "], "statement": "\nThis flaw can be triggered for static error pages only if the readonly property for the DefaultServlet is set to false in the $CATALINA_HOME/conf/web.xml file.  The default for readonly is true.\n\nRed Hat Enterprise Linux 6 is now in Production 3 Phase of the support and maintenance life cycle. This issue has been rated as having Important security impact and may be updated in future releases. For additional information, refer to the Red Hat Enterprise Linux Life Cycle: https://access.redhat.com/support/policy/updates/errata/.\n    ", "cwe": "CWE-501", "cvss3": {"status": "verified", "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "cvss3_base_score": "7.5"}}