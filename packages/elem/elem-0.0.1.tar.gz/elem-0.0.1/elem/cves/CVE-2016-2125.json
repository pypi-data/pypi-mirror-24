{"name": "CVE-2016-2125", "affected_release": [{"advisory": "RHSA-2017:0662", "release_date": "2017-03-21T00:00:00", "cpe": "cpe:/o:redhat:enterprise_linux:6", "product_name": "Red Hat Enterprise Linux 6", "package": "samba-0:3.6.23-41.el6"}, {"advisory": "RHSA-2017:0744", "release_date": "2017-03-21T00:00:00", "cpe": "cpe:/o:redhat:enterprise_linux:6", "product_name": "Red Hat Enterprise Linux 6", "package": "samba4-0:4.2.10-9.el6"}, {"advisory": "RHSA-2017:1265", "release_date": "2017-05-22T00:00:00", "cpe": "cpe:/o:redhat:enterprise_linux:7", "product_name": "Red Hat Enterprise Linux 7", "package": "samba-0:4.4.4-13.el7_3"}, {"advisory": "RHSA-2017:0494", "release_date": "2017-03-23T00:00:00", "cpe": "cpe:/a:redhat:storage:3.2:samba:el6", "product_name": "Red Hat Gluster 3.2 Samba on RHEL-6", "package": "samba-0:4.4.6-4.el6rhs"}, {"advisory": "RHSA-2017:0495", "release_date": "2017-03-23T00:00:00", "cpe": "cpe:/a:redhat:storage:3.2:samba:el7", "product_name": "Red Hat Gluster 3.2 Samba on RHEL-7", "package": "samba-0:4.4.6-4.el7rhgs"}], "public_date": "2016-12-19T00:00:00", "package_state": [{"fix_state": "Affected", "product_name": "Red Hat Gluster Storage 3.1", "package_name": "samba", "cpe": "cpe:/a:redhat:storage:3.1"}, {"fix_state": "Will not fix", "product_name": "Red Hat Enterprise Linux 5", "package_name": "samba3x", "cpe": "cpe:/o:redhat:enterprise_linux:5"}, {"fix_state": "Will not fix", "product_name": "Red Hat Enterprise Linux 5", "package_name": "samba", "cpe": "cpe:/o:redhat:enterprise_linux:5"}], "document_distribution": "Copyright \u00a9 2016 Red Hat, Inc. All rights reserved.", "cvss3": {"status": "verified", "cvss3_scoring_vector": "CVSS:3.0/AV:A/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N", "cvss3_base_score": "6.4"}, "threat_severity": "Moderate", "bugzilla": {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1403114", "description": "\nCVE-2016-2125 samba: Unconditional privilege delegation to Kerberos servers in trusted realms\n    ", "id": "1403114"}, "mitigation": "\nThe following mitigation is suggested by upstream.\n\nThe samba-tool command and the AD DC mode honours the undocumented \"gensec_gssapi:delegation=no\" option in the [global] section of the smb.conf file.\n\nControlling Kerberos forwarding\n===============================\n\nIn the Active Directory world it's possible for administrators to\nlimit the delegation. User and computer objects can both act as\nKerberos users and also as Kerberos services. Both types of objects have an\nattribute called 'userAccountControl' which is a bitmask that controls the\nbehavior of the account. The following three values have impact on possible\ndelegation:\n\n0x00100000: UF_NOT_DELEGATED:\n\nThe UF_NOT_DELEGATED can be used to disable the ability to get forwardable TGT\nfor the account. It means the KDC will respond with an error if the client asks\nfor the forwardable ticket.  The client typically gives up and removes the\nGSS_C_DELEG_FLAG flag and continues without passing delegated credentials.\nAdministrators can use this to disable possible delegation for the most\nprivileged accounts (e.g. administrator accounts).\n\n0x00080000: UF_TRUSTED_FOR_DELEGATION\n\nIf the UF_TRUSTED_FOR_DELEGATION is set on an account a KDC will include the\nOK_AS_DELEGATE flag in a granted service ticket. If the client application\nuses just GSS_C_DELEG_POLICY_FLAG (instead of GSS_C_DELEG_FLAG) gssapi/Kerberos\nlibraries typically only include delegated credentials when the service ticket\nincludes the OK_AS_DELEGATE flag.  Administrators can use this to control which\nservices will get delegated credentials, for example if the service runs in a\ntrusted environment and actually requires the presence of delegated\ncredentials.\n\n0x01000000: UF_TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION\n\nThe UF_TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION is not really relevant for this\nCVE and just listed here for completeness. This flag is relevant for the\nS4U2Proxy feature, where a service can ask the KDC for a proxied service\nticket which can impersonate users to other services.\n    ", "references": ["\nhttps://www.samba.org/samba/security/CVE-2016-2125.html\n    "], "details": ["\n** RESERVED ** This candidate has been reserved by an organization or individual that will use it when announcing a new security problem.  When the candidate has been publicized, the details for this candidate will be provided.\n    ", "\nIt was found that Samba always requested forwardable tickets when using Kerberos authentication. A service to which Samba authenticated using Kerberos could subsequently use the ticket to impersonate Samba to other services or domain users.\n    "], "upstream_fix": "samba 4.5.3, samba 4.4.8, samba 4.3.13", "cvss": {"cvss_scoring_vector": "AV:A/AC:M/Au:N/C:P/I:P/A:N", "status": "verified", "cvss_base_score": "4.3"}}