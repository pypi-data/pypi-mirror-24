{"name": "CVE-2015-3636", "affected_release": [{"advisory": "RHSA-2015:1221", "release_date": "2015-07-14T00:00:00", "cpe": "cpe:/o:redhat:enterprise_linux:6", "product_name": "Red Hat Enterprise Linux 6", "package": "kernel-2.6.32-504.30.3.el6"}, {"advisory": "RHSA-2015:1534", "release_date": "2015-08-06T00:00:00", "cpe": "cpe:/o:redhat:enterprise_linux:7", "product_name": "Red Hat Enterprise Linux 7", "package": "kernel-3.10.0-229.11.1.el7"}, {"advisory": "RHSA-2015:1643", "release_date": "2015-08-18T00:00:00", "cpe": "cpe:/o:redhat:rhel_aus:6.4", "product_name": "Red Hat Enterprise Linux Advanced Update Support 6.4", "package": "kernel-2.6.32-358.65.1.el6"}, {"advisory": "RHSA-2015:1583", "release_date": "2015-08-11T00:00:00", "cpe": "cpe:/o:redhat:rhel_eus:6.5", "product_name": "Red Hat Enterprise Linux Extended Update Support 6.5", "package": "kernel-2.6.32-431.61.2.el6"}, {"advisory": "RHSA-2015:1564", "release_date": "2015-08-05T00:00:00", "cpe": "cpe:/a:redhat:enterprise_mrg:2:server:el6", "product_name": "MRG Grid for RHEL 6 Server v.2", "package": "kernel-rt-1:3.10.0-229.rt56.158.el6rt"}, {"advisory": "RHSA-2015:1565", "release_date": "2015-08-05T00:00:00", "cpe": "cpe:/a:redhat:rhel_extras_rt:7", "product_name": "Red Hat Enterprise Linux for Real Time for NFV (v. 7)", "package": "kernel-rt-3.10.0-229.11.1.rt56.141.11.el7_1"}], "public_date": "2015-05-02T00:00:00", "package_state": [{"fix_state": "Affected", "product_name": "Red Hat Enterprise MRG 2", "package_name": "realtime-kernel", "cpe": "cpe:/a:redhat:enterprise_mrg:2"}, {"fix_state": "Not affected", "product_name": "Red Hat Enterprise Linux 5", "package_name": "kernel", "cpe": "cpe:/o:redhat:enterprise_linux:5"}], "document_distribution": "Copyright \u00a9 2016 Red Hat, Inc. All rights reserved.", "threat_severity": "Moderate", "bugzilla": {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1218074", "description": "\nCVE-2015-3636 kernel: ping sockets: use-after-free leading to local privilege escalation\n    ", "id": "1218074"}, "mitigation": "\nYou can check whether ping socket functionality is enabled by examining the net.ipv4.ping_group_range sysctl value:\n\n~]# sysctl net.ipv4.ping_group_range\nnet.ipv4.ping_group_range = 1\t0\n\n\"1 0\" is the default value and disables the ping socket functionality even for root user. Any other value means that the ping socket functionality might be enabled for certain users on the system.\n\nTo mitigate this vulnerability make sure that you either allow the functionality to trusted local users (groups) only or set the net.ipv4.ping_group_range sysctl to the default and disabled state:\n\n~]# sysctl net.ipv4.ping_group_range=\"1 0\"\n\nPlease note that this might prevent some programs relying on this functionality from functioning properly.\n    ", "details": ["\nThe ping_unhash function in net/ipv4/ping.c in the Linux kernel before 4.0.3 does not initialize a certain list data structure during an unhash operation, which allows local users to gain privileges or cause a denial of service (use-after-free and system crash) by leveraging the ability to make a SOCK_DGRAM socket system call for the IPPROTO_ICMP or IPPROTO_ICMPV6 protocol, and then making a connect system call after a disconnect.\n    ", "\nIt was found that the Linux kernel's ping socket implementation did not properly handle socket unhashing during spurious disconnects, which could lead to a use-after-free flaw. On x86-64 architecture systems, a local user able to create ping sockets could use this flaw to crash the system. On non-x86-64 architecture systems, a local user able to create ping sockets could use this flaw to escalate their privileges on the system.\n    "], "statement": "\nThis issue does not affect the Linux kernel as shipped with Red Hat Enterprise Linux 5. This issue does affect the Linux kernel as shipped with Red Hat Enterprise Linux 6, 7 and Red Hat Enterprise MRG 2. Future kernel updates for the respective releases will address this issue.\n\nPlease note that on x86-64 architecture systems the impact is limited to local Denial of Service and that the ping sockets functionality is disabled by default (net.ipv4.ping_group_range sysctl is \"1\t0\").\n    ", "cwe": "CWE-416", "cvss": {"cvss_scoring_vector": "AV:L/AC:H/Au:S/C:C/I:C/A:C", "status": "verified", "cvss_base_score": "6.0"}}