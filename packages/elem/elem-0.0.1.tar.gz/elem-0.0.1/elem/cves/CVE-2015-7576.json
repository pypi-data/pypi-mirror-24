{"name": "CVE-2015-7576", "affected_release": [{"advisory": "RHSA-2016:0296", "release_date": "2016-02-24T00:00:00", "cpe": "cpe:/a:redhat:rhel_software_collections:2::el6", "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6", "package": "rh-ror41-rubygem-actionpack-1:4.1.5-3.el6"}, {"advisory": "RHSA-2016:0454", "release_date": "2016-03-15T00:00:00", "cpe": "cpe:/a:redhat:rhel_software_collections:2::el6", "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6", "package": "ror40-rubygem-actionpack-1:4.0.2-7.el6"}, {"advisory": "RHSA-2016:0455", "release_date": "2016-03-15T00:00:00", "cpe": "cpe:/a:redhat:rhel_software_collections:2::el6", "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6", "package": "ruby193-rubygem-actionpack-1:3.2.8-16.el6"}, {"advisory": "RHSA-2016:0296", "release_date": "2016-02-24T00:00:00", "cpe": "cpe:/a:redhat:rhel_software_collections:2::el7", "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7", "package": "rh-ror41-rubygem-actionpack-1:4.1.5-3.el7"}, {"advisory": "RHSA-2016:0454", "release_date": "2016-03-15T00:00:00", "cpe": "cpe:/a:redhat:rhel_software_collections:2::el7", "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7", "package": "ror40-rubygem-actionpack-1:4.0.2-7.el7"}, {"advisory": "RHSA-2016:0455", "release_date": "2016-03-15T00:00:00", "cpe": "cpe:/a:redhat:rhel_software_collections:2::el7", "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7", "package": "ruby193-rubygem-actionpack-1:3.2.8-16.el7"}], "public_date": "2016-01-25T00:00:00", "package_state": [{"fix_state": "Will not fix", "product_name": "Red Hat Subscription Asset Manager 1", "package_name": "ruby193-rubygem-actionpack", "cpe": "cpe:/a:redhat:rhel_sam:1"}, {"fix_state": "Will not fix", "product_name": "Red Hat Subscription Asset Manager 1", "package_name": "rubygem-actionpack", "cpe": "cpe:/a:redhat:rhel_sam:1"}], "acknowledgement": "\nRed Hat would like to thank Ruby on Rails project for reporting this issue.\nUpstream acknowledges Daniel Waterworth as the original reporter.\n    ", "document_distribution": "Copyright \u00a9 2016 Red Hat, Inc. All rights reserved.", "upstream_fix": "rubygem-rails 5.0.0.beta1.1, rubygem-rails 4.2.5.1, rubygem-rails 4.1.14.1, rubygem-rails 3.2.22.1", "threat_severity": "Low", "bugzilla": {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1301933", "description": "\nCVE-2015-7576 rubygem-actionpack: Timing attack vulnerability in basic authentication in Action Controller\n    ", "id": "1301933"}, "mitigation": "\nUse following code to monkey-patch http_basic_authenticate_with method in ActionController:\n\n```ruby\n\nmodule ActiveSupport\n  module SecurityUtils\n    def secure_compare(a, b)\n      return false unless a.bytesize == b.bytesize\n\n      l = a.unpack \"C#{a.bytesize}\"\n\n      res = 0\n      b.each_byte { |byte| res |= byte ^ l.shift }\n      res == 0\n    end\n    module_function :secure_compare\n\n    def variable_size_secure_compare(a, b)\n      secure_compare(::Digest::SHA256.hexdigest(a), ::Digest::SHA256.hexdigest(b))\n    end\n    module_function :variable_size_secure_compare\n  end\nend\n\nmodule ActionController\n  class Base\n    def self.http_basic_authenticate_with(options = {})\n      before_action(options.except(:name, :password, :realm)) do\n        authenticate_or_request_with_http_basic(options[:realm] || \"Application\") do |name, password|\n          # This comparison uses & so that it doesn't short circuit and\n          # uses `variable_size_secure_compare` so that length information\n          # isn't leaked.\n          ActiveSupport::SecurityUtils.variable_size_secure_compare(name, options[:name]) &\n            ActiveSupport::SecurityUtils.variable_size_secure_compare(password, options[:password])\n        end\n      end\n    end\n  end\nend\n\n```\n    ", "references": ["\nhttps://groups.google.com/forum/#!msg/rubyonrails-security/ANv0HDHEC3k/mt7wNGxbFQAJ\nhttp://weblog.rubyonrails.org/2016/1/25/Rails-5-0-0-beta1-1-4-2-5-1-4-1-14-1-3-2-22-1-and-rails-html-sanitizer-1-0-3-have-been-released/\n    "], "details": ["\nThe http_basic_authenticate_with method in actionpack/lib/action_controller/metal/http_authentication.rb in the Basic Authentication implementation in Action Controller in Ruby on Rails before 3.2.22.1, 4.0.x and 4.1.x before 4.1.14.1, 4.2.x before 4.2.5.1, and 5.x before 5.0.0.beta1.1 does not use a constant-time algorithm for verifying credentials, which makes it easier for remote attackers to bypass authentication by measuring timing differences.\n    ", "\nA flaw was found in the way the Action Controller component compared user names and passwords when performing HTTP basic authentication. Time taken to compare strings could differ depending on input, possibly allowing a remote attacker to determine valid user names and passwords using a timing attack.\n    "], "cwe": "CWE-385", "cvss": {"cvss_scoring_vector": "AV:N/AC:M/Au:N/C:P/I:N/A:N", "status": "verified", "cvss_base_score": "4.3"}}